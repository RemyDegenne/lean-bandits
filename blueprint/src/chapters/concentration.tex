\chapter{Concentration inequalities}

\begin{definition}[Sub-Gaussian]\label{def:subGaussian}
  \mathlibok
  \lean{ProbabilityTheory.HasSubgaussianMGF}
A real valued random variable $X$ is $\sigma^2$-sub-Gaussian if for any $\lambda \in \mathbb{R}$,
\begin{align*}
  \mathbb{E}\left[e^{\lambda X}\right]
  &\le e^{\frac{\lambda^2 \sigma^2}{2}}
  \: .
\end{align*}
\end{definition}


\begin{lemma}\label{lem:subGaussian_add_of_indepFun}
  \uses{def:subGaussian}
  \mathlibok
  \lean{ProbabilityTheory.HasSubgaussianMGF.add_of_indepFun}
If $X$ is $\sigma_1^2$-sub-Gaussian and $Y$ is $\sigma_2^2$-sub-Gaussian, and $X$ and $Y$ are independent, then $X + Y$ is $(\sigma_1^2 + \sigma_2^2)$-sub-Gaussian.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:hoeffding_one}
  \uses{def:subGaussian}
  \mathlibok
  \lean{ProbabilityTheory.HasSubgaussianMGF.measure_ge_le}
For $X$ a $\sigma^2$-sub-Gaussian random variable, for any $t \ge 0$,
\begin{align*}
  \mathbb{P}(X \ge t)
  &\le \exp\left(- \frac{t^2}{2 \sigma^2}\right)
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{theorem}\label{thm:hoeffding}
  \uses{def:subGaussian}
  \mathlibok
  \lean{ProbabilityTheory.HasSubgaussianMGF.measure_sum_range_ge_le_of_iIndepFun}
Let $X_1, \ldots, X_n$ be independent random variables such that $X_i$ is $\sigma_i^2$-sub-Gaussian for $i \in [n]$.
Then for any $t \ge 0$,
\begin{align*}
  \mathbb{P}\left(\sum_{i=1}^n X_i \ge t\right)
  &\le \exp\left(- \frac{t^2}{2 \sum_{i=1}^n \sigma_i^2}\right)
  \: .
\end{align*}
\end{theorem}

\begin{proof}\leanok
  \uses{lem:subGaussian_add_of_indepFun, lem:hoeffding_one}

\end{proof}


\begin{lemma}\label{lem:measure_sum_le_sum_le'}
  \uses{def:subGaussian}
  \leanok
  \lean{ProbabilityTheory.HasSubgaussianMGF.measure_sum_le_sum_le'}
Let $X_1, \ldots, X_n$ be random variables such that $X_i - P[X_i]$ is $\sigma_{X,i}^2$-sub-Gaussian for $i \in [n]$.
Let $Y_1, \ldots, Y_m$ be random variables such that $Y_i - P[Y_i]$ is $\sigma_{Y,i}^2$-sub-Gaussian for $i \in [m]$.
Suppose further that the vectors $X$ and $Y$ are independent and that $\sum_{i = 1}^m P[Y_i] \le \sum_{i = 1}^n P[X_i]$.
Then
\begin{align*}
  \mathbb{P}\left(\sum_{i=1}^m Y_i \ge \sum_{i=1}^n X_i\right)
  &\le \exp\left(- \frac{\left(\sum_{i = 1}^n P[X_i] - \sum_{i=1}^m P[Y_i]\right)^2}{2 \sum_{i=1}^n (\sigma_{X,i}^2 + \sigma_{Y,i}^2)}\right)
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:subGaussian_add_of_indepFun, thm:hoeffding}

\end{proof}
